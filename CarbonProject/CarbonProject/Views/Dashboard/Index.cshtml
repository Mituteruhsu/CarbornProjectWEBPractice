@model CarbonProject.Controllers.DashboardController.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}


<h2 class="text-center">企業碳排放數據與目標</h2>
<p class="text-center">平均減碳目標比例：@Model.AvgReductionPercent.ToString("F2")% / 平均目標排放量：@Model.AvgTotalEmission.ToString("N0") 噸</p>
<div class="row g-4">
    <div class="col-md">
        <div class="card shadow-sm border-1 text-white h-100">
            <div class="card-body">
                <h6 class="card-title text-uppercase fw-bold">企業平均排放統計</h6>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>年份</th>
                            <th>參與公司數量</th>
                            <th>該年總排放量 (Sum)</th>
                            <th>跨年度平均 (Avg of Sum)</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.YearlyEmissionAverages)
                        {
                            <tr>
                                <td>@item.Year</td>
                                <th>@item.CompanyCount</th>
                                <td>@item.TotalEmissionSum.ToString("N4")</td>
                                <td>@item.AverageAcrossYears.ToString("N4")</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="col-md">
        <div class="card shadow-sm border-1 text-white h-100">
            <div class="card-body">
                <h6 class="card-title text-uppercase fw-bold">參與企業平均區勢</h6>
                <!-- 隱藏資料給外部 JS 使用 -->
                <div id="yearlyData" style="display:none">
                    @Model.AvgTotalEmission.ToString("N0")
                    @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.YearlyEmissionAverages))
                </div>
                <canvas class="my-4 w-100"
                        id="emissionChart"
                        width="900"
                        height="380"></canvas>                
            </div>
        </div>
    </div>
</div>

