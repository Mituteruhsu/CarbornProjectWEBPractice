@model List<CarbonProject.Models.Members>
@{
    ViewData["Title"] = "會員管理";
}

<h2 style="margin-bottom:20px;">會員管理</h2>

@if (TempData["AdminError"] != null)
{
    <div style="color:red; margin-bottom:10px;">@TempData["AdminError"]</div>
}

<table border="1" cellpadding="5" cellspacing="0" style="border-collapse:collapse; width:100%;">
    <thead style="background:#f3f4f6;">
        <tr>
            <th>ID</th>
            <th>帳號</th>
            <th>Email</th>
            <th>姓名</th>
            <th>角色</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var m in Model)
        {
            <tr>
                <form id="memberForm" method="post">
                    @Html.AntiForgeryToken()
                <td>@m.MemberId<input type="hidden" name="id" value="@m.MemberId" autocomplete="off" /></td>
                <td><input type="text" name="username" value="@m.Username" style="width:100px;" autocomplete="off" /></td>
                <td><input type="email" name="email" value="@m.Email" style="width:160px;" autocomplete="off" /></td>
                <td><input type="text" name="fullname" value="@m.FullName" style="width:120px;" autocomplete="off" /></td>
                    <td>@m.Role</td>
                    <td>
                        <button type="button" onclick="submitForm('EditMember')" style="background:#4CAF50; color:white; border:none; padding:5px 10px;">儲存</button>
                    <input type="hidden" name="id" value="@m.MemberId" autocomplete="off" />
                        <button type="button" onclick="submitForm('DeleteMember');return confirm('確定要刪除嗎？');" style="background:#f87171; color:white; border:none; padding:5px 10px;">
                            刪除
                        </button>
                    </td>
                </form>
                
            </tr>
        }
    </tbody>
</table>

<a asp-controller="Account" asp-action="Logout" style="display:inline-block; margin-top:20px;">登出</a>

<script>
    function submitForm(actionName) {
        var form = document.getElementById('memberForm');
        form.action = '/Account/' + actionName; // 動態改 form 的 action
        form.submit();
    }
</script>