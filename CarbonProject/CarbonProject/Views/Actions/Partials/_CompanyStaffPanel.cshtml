@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@{
    Layout = null;
    var isLogin = HttpContextAccessor.HttpContext?.Session.GetString("isLogin") == "true";
    var username = HttpContextAccessor.HttpContext?.Session.GetString("Username");
    var role = HttpContextAccessor.HttpContext?.Session.GetString("Roles");

    if (!isLogin || role == null)
    {
        <text>
            <script>
                window.location.href = '/Account/Login';
            </script>
        </text>
    }
}

<!-- Sidebar -->
<div id="sidebar" class="spring-sidebar shadow">
    <ul class="nav flex-column px-3">
        <li class="nav-item pt-3 px-3">
            <h5 class="fw-bold text-success">公司管理員面板</h5>
        </li>
        <li class="nav-item mb-1">
            <a asp-controller="Admin" asp-action="Dashboard"
               class="nav-link sidebar-link"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a>
        </li>

        @* Role-based *@
        @if (role == "Admin" || role == "Staff")
        {
            <li class="nav-item mb-1">
                <a asp-controller="Users" asp-action="Index"
                   class="nav-link sidebar-link"><i class="bi bi-people me-2"></i>使用者管理</a>
            </li>

            <li class="nav-item mb-1">
                <a asp-controller="RBAC" asp-action="Index"
                   class="nav-link sidebar-link"><i class="bi bi-shield-lock me-2"></i>角色權限</a>
            </li>
            <li class="nav-item mb-1">
                <a asp-controller="Profile" asp-action="Index"
                   class="nav-link sidebar-link"><i class="bi bi-person-badge me-2"></i>個人帳號管理</a>
            </li>
            <li><a href="/Company/Tasks">我的任務</a></li>
            <li><a href="/Company/MyReports">我提交的報告</a></li>
        }
    </ul>
</div>
<div class="company-staff-panel">
    <h4>員工面板</h4>
</div>